---
title: "How Weather Has Affected the Outcomes of Patriots Games Since 2000"
subtitle: "Data Science 1 with R (STAT 301-1)"
author: "Leo McKenna"
date: today

format:
  html:
    toc: true
    embed-resources: true
    code-fold: show
    link-external-newwindow: true

execute:
  warning: false
  
from: markdown+emoji 
---

::: {.callout-tip icon=false}

## Github Repo Link

[https://github.com/stat301-1-2023-fall/final-project-1-leomckenna.git](https://github.com/stat301-1-2023-fall/final-project-1-leomckenna.git)

:::

```{r}
#| results: hide
library(tidyverse)
library(knitr)
library(skimr)
rain_cleaned <- read_rds("data/rain_data.rds")
temp_cleaned <- read_rds("data/temp_data.rds")
snow_cleaned <- read_rds("data/snow_data.rds")
monthly_pats_elo <- read_rds("data/elo_data.rds")
pats_games <- read_rds("data/game_data.rds")
pats_weather_data <- read_rds("data/pats_weather_data.rds")
```


## **Introduction**

I chose to look for a relationship between weather and the outcomes of Patriots games for a few reasons. Firstly, I’m a lifelong football fan, and I think the statistical side of the sport is largely unexplored. In the last few decades there has been an explosion of statistical study in sports like baseball, but football has been lagging behind. There are so many interesting, complex events in the NFL that statistics and data science could give insight to. One of those questions is the one I ask in this report. Is it really true that the Patriots play better than other teams in the cold? It makes sense that they would because they play in the freezing cold more than many other teams in the league. 

Secondly, I have been playing in Scrabble Tournaments since I was in middle school, and in competitive Scrabble, the ELO rating system is used. However, I know almost nothing about it, and so I was hoping this nfl_elo data set would shed some light on how ELO works and changes based on game outcomes. 

## **Data Overview & Quality**
The data I collected from FiveTHirtyEight, namely the nfl_elo.csv and nfl_games.csv data sets, were already collected and well cleaned and had their own code books. The nfl_elo.csv did have a lot of explicit missingness issues, because it keeps track of variables that have only begun being calculated in recent years. To offset this, I chose to study data from only this century so that this problem would not linger. There are 33 total variables, 27 numeric and 6 categorical,  and 17,379 observations dating back to 1920. The nfl_games.csv data set included a lot of superfluous variables that I did not care about. However, it does contain some data that was implicitly missing from the nfl_elo.csv data set. The ELO data did not contain any information about the location or stadiums of the games, the coaches or referees of each game, the week of the NFL season in which each game happened, or any observations about the weather from any of the games. So while the ELO data didn't need any cleaning, it was hard to actually do any of the analysis I wanted to without first joining it with the games data set.

The three weather data sets that I downloaded from the National Oceanic and Atmospheric Administration's Data on the National Weather Service's website came as .pdf files, and there were certainly some issues with the data. First of all, it was in an odd format, so I had to convert all of it to .csv files and then clean the data so I could get rid of information I didn't need and put it in a format that I could analyze. Secondly, the data from 2000-2023 for all three data sets, i.e. the data about rain, temperature, and weather, had a surprising amount of missingness issues. There were full months in which the weather service had not collected any data about these three metrics from the weather tower in Foxboro.

## **Exploratory Data Analysis**
### **Univariate Analysis**
I began my EDA by exploring the distributions of each individual variable I cared about. I started with the three data sets related to weather, namely rain_data.rds, temp_data.rds and snow_data.rds.

The rain_data.rds data set has two important variables to look at: annual_precipitation, and monthly_precipitation. The distribution of these two variables over the time frame 2000 to 2020 look like this:
```{r}
#| results: hide
rain_cleaned |> 
  ggplot(aes(as.Date(paste(year, month, "01"), format = "%Y %b %d"),annual_mean_rain)) +
  geom_line(color = "darkblue", size = 1.5) +
  labs(x = "Time", y = "Annual Mean Rain", title = "Annual Mean Rain in Foxboro From 2000-2020") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),  
        plot.title = element_text(hjust = 0.5),             
        axis.title = element_text(face = "bold"))
```

```{r}
#| results: hide
rain_cleaned |> 
  ggplot(aes(as.Date(paste(year, month, "01"), format = "%Y %b %d"), monthly_mean_rain)) +
  geom_line(color = "darkblue", size = 0.5) +
  labs(x = "Time", y = "Mean Monthly Precipitation", title = "Mean Monthly Precipitation in Foxboro From 2000-2020") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),  
        plot.title = element_text(hjust = 0.5),             
        axis.title = element_text(face = "bold"))
```
The first plot tells us that 
The second plot tells us that

Next I looked at the temp_data.rds data set, and again looked for trends over time in the annual_mean_temp and monthly_mean_temp variables. Those plots look like this:

```{r}
#| results: hide
# Plot 1: Bar plot for annual mean temperature
temp_cleaned |> 
  ggplot(aes(as.factor(year), annual_mean_temp)) +
  geom_bar(stat = "summary", fun = "mean", fill = "darkred", color = "black", alpha = 0.7) +
  labs(x = "Year", y = "Annual Mean Temperature", title = "Annual Mean Temperature in FoxboroFrom 2000-2023") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
#| results: hide
# Plot 2: Bar plot for monthly mean temperature
month_order <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
temp_cleaned |> 
  ggplot(aes(x = factor(month, levels = month_order), y = monthly_mean_temp)) +
  geom_bar(stat = "summary", fun = "mean", fill = "darkred", color = "black", alpha = 0.7) +
  labs(x = "Month", y = "Monthly Mean Temperature", title = "Monthly Mean Temperature in Foxboro from 2000-2023") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Again, what we can glean from these plots is that: blah. This is backed up by the summary statisic calculations that I did for this data set:

Insert table

This shows us that blah.

Finally, I looked at the annual and monthly snowfall in the snow_data.rds data set:

```{r}
#| results: hide
 snow_cleaned |> 
  ggplot(aes(year, annual_snowfall, group = 1)) +
  geom_line() +
  geom_point() +
  labs(title = "Annual Snowfall From 2000-2022", x = "Year", y = "Annual Snowfall (inches)") +
  theme_minimal()
```

```{r}
#| results: hide
snow_cleaned |> 
  filter(!is.na(snowfall)) |> 
  ggplot(aes(month, snowfall, group = year, color = year)) +
  geom_line() +
  geom_point() +
  facet_wrap(~year, scales = "free_y", ncol = 4) +
  labs(title = "Monthly Snowfall From 2000-2022", x = "Month", y = "Snowfall (inches)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```










## **Conclusion**
I am definitely surprised at the results of my exploratory data analysis. I figured there would be a strong negative correlation between temperature and success, but the results were mostly inconclusive. I found a slight correlation between an increase in rain and snow and wins for the Patriots, but 




## **References — if needed**
https://github.com/fivethirtyeight/data/tree/master/nfl-elo

https://github.com/nflverse/nfldata/blob/master/DATASETS.md#games

https://www.weather.gov/wrh/Climate?wfo=box

